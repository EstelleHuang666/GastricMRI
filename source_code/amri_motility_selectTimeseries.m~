function [time_series] = amri_motility_selectTimeseries(profile)

%{

##amri_motility_selectTimeseries:
Extract time series from a row in the motility map.

##Environment requirement:  
This code was developed under Red Hat Enterprise Linux environment.

##Usage
[time_series] = amri_motility_selectTimeseries(profile)

##Inputs
profile: 2D motility plot (X: time, Y: location along the antral axis)

##Output
time_series: 3 contraction time series on antral axis
                    (1 at selected location, 2 at above/below the location with 2 pixels spacing)

##History:
1.00 - 10/25/2017 - KHLU - create the original file

##Version:
1.00

%}

profile_for_plotting = profile;

%-- plot spatio-temporal map
FigHandle = figure(1);
set(FigHandle, 'Position', [400, 400,900,360]);
imagesc(profile_for_plotting);
colormap gray
set(gca,'XTickLabel','','YTickLabel','');

%-- select two lines for obtaining the line profile
fprintf('Please click on a location to sample the intensity profile\n');
[xc,yc] = ginput(1);
fprintf('You clicked at (x,y)=(%.1f,%.1f)',xc,yc);
pos = [xc,yc];
index = int16(pos(2));
fprintf(['\nRow: ' num2str(index) ' has been chosen!\n']);

%-- select index from the profile
time_series = zeros(3,size(profile,2));
time_series(1,:) = profile(index-2,:);
time_series(2,:) = profile(index,:);
time_series(3,:) = profile(index+2,:);

%-- plot time series
hold on;
plot(1:size(time_series,2),repmat(index,1,size(time_series,2)),'w-','linewidth',2);

pause(2);
close(FigHandle);

end

